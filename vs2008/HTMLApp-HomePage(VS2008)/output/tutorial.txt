<P>/* <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt;&gt; API List &lt;&lt;&lt;</P>
<P>// DB 연결하기 <BR>function API_ConnectDB(DBName)<BR>function API_SQL(Query)<BR>function API_GetRow()<BR>function API_GetValue(sIndx)</P>
<P>// JDBMaster Class<BR>function JDBMaster()<BR>{<BR>}<BR>JDBMaster.prototype.Connect = function(DBName)<BR>JDBMaster.prototype.SQL = function(Query)<BR>JDBMaster.prototype.GetRow = function()<BR>JDBMaster.prototype.GetValue = function(sIndx)</P>
<P>// File API<BR>function API_OpenFile(fName)<BR>function API_CreateFile(fName)<BR>function API_CloseFile(f)<BR>function API_WriteFile(f, pData)<BR>function API_ReadFile(f)<BR>function API_DeleteFile(fName)<BR>function API_CopyFile(fSrc, fDst)<BR>function API_GetFileSize(f)</P>
<P>// File Class<BR>function JFile()<BR>{<BR>&nbsp;&nbsp;&nbsp; this.m_fHandle; // FIle 핸들<BR>&nbsp;&nbsp;&nbsp; this.m_fName&nbsp; ; // File Name<BR>&nbsp;&nbsp;&nbsp; this.State&nbsp;&nbsp;&nbsp; ;&nbsp; // 0:close, 1:오픈, 2:Create<BR>}</P>
<P>JFile.prototype.Open&nbsp;&nbsp; = function(fName)<BR>JFile.prototype.Create = function(fName)<BR>JFile.prototype.Close&nbsp; = function()<BR>JFile.prototype.Write&nbsp; = function(pData)<BR>JFile.prototype.Read&nbsp;&nbsp; = function()<BR>JFile.prototype.GetSize = function()</P>
<P>// SYstem API <BR>function API_System(pParam)<BR>function API_excute(pParam)</P>
<P>// Folder API<BR>function API_GetCurFolder()<BR>function API_SetFolder(pParam)<BR>function API_SearchFolder(pParam)</P>
<P>// CGI API<BR>function API_CGICall(pParam)</P>
<P>// HTML API<BR>function UI_CLEAR_HTML()<BR>function UI_ADD_HTML(sText)<BR>function UI_ATTACH_BOARD(num)</P>
<P>*/</P>
<P><BR>1. HTML내에 다음 내용을 Copy &amp; Paste한다.<BR>----------------------------------------------------------------------------------<BR>&lt;!--------------------------------------------------&gt;<BR>&lt;!-- MAIN 처리&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&gt;<BR>&lt;!--------------------------------------------------&gt;</P>
<P>&lt;!--<BR>&nbsp;&nbsp;&nbsp;&nbsp; Data연동을 위한 보이지않는 변수컨 control <BR>&nbsp;&nbsp;&nbsp;&nbsp; URL 식으로 넘기면 Decode를 해주어야 하므로..<BR>&nbsp;&nbsp;&nbsp;&nbsp; 효율적관리를 위해 기본 컨트롤 지정함<BR>--&gt;<BR>&lt;textarea rows="12" id = 'RESULT' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 일반 API결과값저장<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FileRESULT' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File API 결과값저장<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FileREAD' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File Read 저장(Text Buffer)<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FileWrite' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File Write 저장(Text Buffer)<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FileTarget' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 파일삭제나 복사시 타겟 파일명<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FileSource' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 복사시 소스 파일명<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FolderRESULT' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 폴더 API 결과값 저장<BR>&lt;/textarea&gt;<BR>&lt;textarea rows="12" id = 'FolderIN' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 폴더 API 파라메터 저장<BR>&lt;/textarea&gt;</P>
<P>&lt;textarea rows="12" id = 'CGIRESULT' name="propose_body1" cols="60" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; style="font-family: 굴림체; display:none;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; background-color: #EEEEEE;font-size: 9pt; border: 3 solid #AAAAAA"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CGI 콘솔 Output 결과값 저장<BR>&lt;/textarea&gt;</P>
<P>&lt;script language="JavaScript1.2" src = "res://AppLayer.dll/api.js"&gt;&lt;/script&gt;<BR>&lt;script language="JavaScript1.2" src = "main.js"&gt;&lt;/script&gt;<BR>&lt;script language="JavaScript1.2"&gt;<BR>&nbsp;&nbsp;&nbsp; JMain(0, " ")<BR>&lt;/script&gt;</P>
<P>-----------------------------------------------------------------------------------<BR>2. 화면에 출력될 DOM을 정의한다. 'BOARD_' + 번호 형식으로 계속 추가가능</P>
<P>&lt;DIV id = 'BOARD_1' style= "font-family: 굴림체;font-size: 9pt;"&gt;&nbsp;&nbsp;<BR>&lt;/DIV&gt;</P>
<P>&lt;DIV id = 'BOARD_2' style= "font-family: 굴림체;font-size: 9pt;"&gt;&nbsp;&nbsp;<BR>&lt;/DIV&gt;</P>
<P>&lt;DIV id = 'BOARD_3' style= "font-family: 굴림체;font-size: 9pt;"&gt;&nbsp;&nbsp;<BR>&lt;/DIV&gt;</P>
<P>-----------------------------------------------------------------------------------</P>
<P>3. 소스예제</P>
<P>// API 테스트및 예제용<BR>function APITest()<BR>{<BR>&nbsp;&nbsp;&nbsp; var Db = new JDBMaster();<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; var sRst = Db.Connect("AppManager.mdb");&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; if(sRst != "true") return;<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; var sql = "select title, detailinfo from t_program_tips";<BR>&nbsp;&nbsp;&nbsp; var sRst = Db.SQL(sql);<BR>&nbsp;&nbsp;&nbsp; if(sRst != "true") return;<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; while(Db.GetRow() =="continue"){<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;hr&gt;");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;pre&gt;");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage(Db.GetValue(0));</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;/pre&gt;");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;pre&gt;");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage(Db.GetValue(1));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;/pre&gt;");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; // Insert Test<BR>&nbsp;&nbsp;&nbsp; var sql2 = "insert into t_program_tips(title, detailinfo) values (' 231312 ', 'testing')";<BR>&nbsp;&nbsp;&nbsp; var sRst2 = Db.SQL(sql2);<BR>&nbsp;&nbsp;&nbsp; if(sRst2 != "true") return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // delete Test<BR>&nbsp;&nbsp;&nbsp; var sql3 = "delete from t_program_tips where title = ' 231312 ' and&nbsp; detailinfo = 'testing'";<BR>&nbsp;&nbsp;&nbsp; var sRst3 = Db.SQL(sql3);<BR>&nbsp;&nbsp;&nbsp; if(sRst3 != "true") return;&nbsp;&nbsp;&nbsp; </P>
<P>&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // System Test<BR>&nbsp;&nbsp;&nbsp; API_System("copy c:\\a.txt c:\\b.txt");<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // Folder API 테스트<BR>&nbsp;&nbsp;&nbsp; var sFolder = API_GetCurFolder();<BR>&nbsp;&nbsp;&nbsp; //API_SearchFolder("c:\\")&nbsp;&nbsp; <BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;hr&gt;");<BR>&nbsp;&nbsp;&nbsp; WriteMessgage(sFolder);<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; sFolder+= "\\";<BR>&nbsp;&nbsp;&nbsp; API_SearchFolder(sFolder);<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // File Test<BR>&nbsp;&nbsp;&nbsp; var fWrite = new JFile();<BR>&nbsp;&nbsp;&nbsp; var TXTName = sFolder+ "<A href="file://\\a.txt">\\a.txt</A>";<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; fWrite.Create(TXTName);<BR>&nbsp;&nbsp;&nbsp; fWrite.Write ("원숭이가 나무에 올라가~~. 몽키매직.. 몽키매직..");<BR>&nbsp;&nbsp;&nbsp; fWrite.Close();<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; var fRead = new JFile();<BR>&nbsp;&nbsp;&nbsp; fRead.Open(TXTName);<BR>&nbsp;&nbsp;&nbsp; var str = fRead.Read();<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;hr&gt;");<BR>&nbsp;&nbsp;&nbsp; WriteMessgage(str);<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; var fSize = fRead.GetSize();<BR>&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;hr&gt;");<BR>&nbsp;&nbsp;&nbsp; WriteMessgage("FIleSize:" + fSize);<BR>&nbsp;&nbsp;&nbsp; WriteMessgage("&lt;hr&gt;");<BR>&nbsp;&nbsp;&nbsp; fRead.Close();<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; var fName = sFolder+ "<A href="file://\\a.bat">\\a.bat</A>";<BR>&nbsp;&nbsp;&nbsp; var outText = API_CGICall( fName );<BR>&nbsp;&nbsp;&nbsp; if(outText != "") alert(outText);<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; // Copy, Delete<BR>&nbsp;&nbsp;&nbsp; var fName2 = sFolder+ "<A href="file://\\b.bat">\\b.bat</A>";<BR>&nbsp;&nbsp;&nbsp; var fName3 = sFolder+ "<A href="file://\\b.bat">\\b.bat</A>";<BR>&nbsp;&nbsp;&nbsp; API_CopyFile(fName, fName2);<BR>&nbsp;&nbsp;&nbsp; API_CopyFile(fName, fName3);<BR>&nbsp;&nbsp;&nbsp; API_DeleteFile(fName3);&nbsp;&nbsp;&nbsp; <BR>}<BR></P>